<!--
/***************************************
 * @file popover.html
 * @author Travis Roman (travis@toggleable.com)
 * @package JavaScript Blocker (http://javascript-blocker.toggleable.com)
 ***************************************/
-->

<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8" />
	
	<title></title>
		
	<link rel="stylesheet" href="css/poppy.css" type="text/css" id="poppy-style" />
	<link rel="stylesheet" href="css/main.css" type="text/css" id="main-style"/>
	<link rel="stylesheet" href="css/highlight.css" />
	
	<script src="js/highlight.js"></script>
	<script>
		_ = safari.extension.globalPage.contentWindow._;
		
		document.addEventListener('DOMContentLoaded', function () {
			safari.extension.globalPage.contentWindow.JavaScriptBlocker.hljs = hljs;
			setTimeout(function () {
				safari.extension.globalPage.contentWindow.JavaScriptBlocker.bind_events();
			}, 200);
			
			var inputs = document.getElementsByTagName('input'),
					ogroups = document.getElementsByTagName('optgroup'),
					i,
					b;
					
			for (i = 0; i < inputs.length; i++) {
				if (inputs[i].value && inputs[i].value.length) inputs[i].value = _(inputs[i].value);
				if (inputs[i].placeholder && inputs[i].placeholder.length) inputs[i].placeholder = _(inputs[i].placeholder);
			}
			for (b = 0; b < ogroups.length; b++)
				ogroups[b].label = _(ogroups[b].label);
				
			if (window.navigator.platform.match(/Win/)) document.body.className += ' windows';
			else if (window.navigator.platform.match(/Mac/)) document.body.className += ' macos';
		});
		
		window.addEventListener('message', function (event) {
			if (event.data === 'reloadOnce') window.location.reload();
		});
	</script>
</head>

<body class="blocking-mode">
	<header><h1><script>document.write(_('JavaScript Blocker'));</script></h1></header>
	
	<div id="container">
		<div id="find-bar">
			<input type="button" id="find-bar-done" value="Done" />
			<input type="search" id="find-bar-search" incremental="incremental" results="10" autosave="find_on" />
			<label for="find-bar-search" id="find-bar-matches"></label>
		</div>
		<div id="update-information" class="whoop">
			<h2>Important Update Information</h2>
			<p>
				JavaScript Blocker has been updated to version 2 and with it brings many changes which may affect you.
				For full details on all the changes included in this update, please review the <a class="outside" href="http://javascript-blocker.toggleable.com/change-log/200">change log</a>.
			</p>
			<h3>Major Changes</h3>
			<ol>
				<li>
					<p>
						The ability to disable <b>Block scripts manually</b> has been removed. Blocking scripts is now completely done
						with the help of automatic actions. Check out the new setting <b>Automatically block scripts from</b> and configure
						it to your liking.
					</p>
					<div class="divider"></div>
				</li>
				<li>
					<p>
						You can no longer choose which domain to add a rule for. All rules are now added to the exact hostname displayed in the
						URL. If you want to add a rule for <b>All Domains</b>, you can still do so from the rule listing.
					</p>
					<div class="divider"></div>
				</li>
				<li>
					<p>
						The button to switch between the simple and expert interfaces has been removed. The only way to toggle views is to enable
						or disable expert features. This change was brought about because rules are no longer interchangeable between the two modes.
					</p>
					<div class="divider"></div>
				</li>
				<li>
					<p>
						Unblockable scripts are no longer displayed by default. You can turn this on from the preferences if you desire.
					</p>
					<div class="divider"></div>
				</li>
				<li>
					<p>
						When expert features are disabled, JavaScript Blocker will run in a simplified mode which is for rule creation only.
						All rules created in this mode are considered high-priority. You will be able to easily allow or block scripts
						from hostnames and their sub domains.
					</p>
				</li>
			</ol>
			<p><input type="button" value="Understood" id="understood" /></p>
		</div>
		<div id="setup" class="whoop">
			<p>
				<a class="outside" href="http://javascript-blocker.toggleable.com/">
					<img src="images/toggleable.png" alt="Toggleable" style="margin-bottom: -5px;"/>
					<img src="Icon-32.png" alt="JS Blocker" />
				</a>
			</p>
			<p><script>document.write(_('Thanks for using {1}', [_('JavaScript Blocker')]));</script></p>
			<p>
				<input type="checkbox" id="setup-simple" checked="checked" /> <label for="setup-simple"><script>document.write(_('Setup:Simple Mode'));</script></label>
			 	<a href="javascript:void(0)" id="setup-help-simple" class="help-link"><script>document.write(_('?'));</script></a>
			</p>
			<p>
				<input type="checkbox" id="block-manual" checked="checked" /> <label for="block-manual"><script>document.write(_('Block scripts manually'));</script></label>
			</p>
			<p>
				<input type="checkbox" id="secure-only" /> <label for="secure-only"><script>document.write(_('Scripts on secure sites must also be secure'));</script></label>
			</p>
			<p><input type="button" id="finish-setup" value="Finish Setup" /></p>
		</div>
		<div id="main" class="whoop">
			<div id="page-lists">
				<label><script>document.write(_('Page:'));</script></label>
				<select id="page-list">
					<optgroup label="Main Page">
						<option>http://javascript-blocker.toggleable.com</option>
					</optgroup>
					<optgroup label="Inline Frame Pages">
						<option>http://example.com</option>
					</optgroup>
				</select>
			</div>
			<div class="info-container">
				<label class="allowed-label"><script>document.write(_('Allowed:'));</script></label> <span id="allowed-scripts-count">0</span>
				<input type="button" value="Block All" id="block-domain" />
			</div>
	
			<div id="allowed-script-urls">
				<ul class="main-wrapper"></ul>
			</div>
	
			<div class="info-container">
				<label class="blocked-label"><script>document.write(_('Blocked:'));</script></label> <span id="blocked-scripts-count">0</span>
				<input type="button" value="Allow All" id="allow-domain" />
			</div>
	
			<div id="blocked-script-urls">
				<ul class="main-wrapper"></ul>
			</div>
	
			<div class="info-container">
				<label class="unblocked-label"><script>document.write(_('Unblocked:'));</script></label> <span id="unblocked-scripts-count">0</span>
			</div>
	
			<div id="unblocked-script-urls">
				<ul class="main-wrapper"></ul>
			</div>

			<div id="disclaimer">
				<p>
					<input type="button" value="Show Rules" id="view-rules" />
					<a href="http://javascript-blocker.toggleable.com/help" class="link-button outside" id="js-help"><script>document.write(_('Help'));</script></a>
					<a href="http://javascript-blocker.toggleable.com/" class="link-button outside" id="js-help"><script>document.write(_('Project Page'));</script></a>
					<input type="button" value="Disable JavaScript Blocker" id="disable" />
					<br style="clear:both;">
				</p>
				<br style="clear:both;">
			</div>
		</div>
		<div id="rules-list" class="whoop">
			<div class="info-container">
				<p class="misc-info">0 domains, 0 rules</p>
				<input type="button" value="Close Rules List" id="rules-list-back" />
			</div>
			<div id="data">
				<a href="javascript:void(0)" id="collapse-all"><script>document.write(_('Collapse All'));</script></a> <span class="label">—</span>
				<a href="javascript:void(0)" id="expand-all"><script>document.write(_('Expand All'));</script></a> <span class="label">￨</span>
				<a href="javascript:void(0)" id="edit-domains"><script>document.write(_('Edit'));</script></a> <span class="label">￨</span>
				<a href="javascript:void(0)" id="reinstall-pre"><script>document.write(_('Reinstall Whitelist & Blacklist'));</script></a>
				<div id="rules-filter-bar" class="filter-bar">
					<ul id="filter-type-collapse">
						<li id="filter-all"class="selected"><script>document.write(_('All'));</script></li>
						<li id="filter-collapsed"><script>document.write(_('Collapsed'));</script></li>
						<li id="filter-expanded"><script>document.write(_('Expanded'));</script></li>
					</ul>
					<ul id="filter-type-state">
						<li class="filter-divider">|</li>
						<li id="filter-state-all" class="selected"><script>document.write(_('Any'));</script></li>
						<li id="filter-enabled"><script>document.write(_('Enabled'));</script></li>
						<li id="filter-disabled"><script>document.write(_('Disabled'));</script></li>
					</ul>
					<br style="clear:both;" />
				</div>
				<div id="rules-filter-bar-two" class="filter-bar">
					<ul>
						<li id="li-domain-filter"><input type="search" placeholder="Domains" incremental="incremental" results="10" autosave="domain_filter" id="domain-filter" /><br style="clear:both;" /></li>
					</ul>
					<br style="clear:both;" />
				</div>
				<ul id="rules-list-rules"></ul>
			</div>
		</div>
		<div id="misc" class="whoop">
			<div class="info-container">
				<p class="misc-header"></p>
				<input type="button" value="Close" id="misc-close" />
			</div>
			<div id="misc-content"></div>
		</div>
	</div>
</body>
</html>