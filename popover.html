<!--
/***************************************
 * @file popover.html
 * @author Travis Roman (travis@toggleable.com)
 * @package JavaScript Blocker (http://javascript-blocker.toggleable.com)
 ***************************************/
-->

<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8" />
	
	<title></title>
		
	<link rel="stylesheet" href="css/poppy.css" type="text/css" id="poppy-style" />
	<link rel="stylesheet" href="" type="text/css" id="poppy-theme-style" />
	<link rel="stylesheet" href="css/main.css" type="text/css" id="main-style"/>
	<link rel="stylesheet" href="" type="text/css" id="main-theme-style"/>
	<link rel="stylesheet" href="css/main.large.css" type="text/css" id="main-large-style"/>
	<link rel="stylesheet" href="css/highlight.css" />
	
	<script src="js/highlight.js"></script>
	<script>
		_ = safari.extension.globalPage.contentWindow._;
		
		document.addEventListener('DOMContentLoaded', function () {
			safari.extension.globalPage.contentWindow.JavaScriptBlocker.hljs = hljs;
			
			setTimeout(function () {
				safari.extension.globalPage.contentWindow.JavaScriptBlocker.bind_events();
			}, 300);
			
			var inputs = document.getElementsByTagName('input'),
					ogroups = document.getElementsByTagName('optgroup'),
					i,
					b;
					
			for (i = 0; i < inputs.length; i++) {
				if (inputs[i].value && inputs[i].value.length) inputs[i].value = _(inputs[i].value);
				if (inputs[i].placeholder && inputs[i].placeholder.length) inputs[i].placeholder = _(inputs[i].placeholder);
			}
			for (b = 0; b < ogroups.length; b++)
				ogroups[b].label = _(ogroups[b].label);
				
			if (window.navigator.platform.match(/Win/)) document.body.className += ' windows';
			else if (window.navigator.platform.match(/Mac/)) document.body.className += ' macos';
			
			document.body.className += ' theme-' + safari.extension.globalPage.contentWindow.JavaScriptBlocker.theme;
		});
		
		window.addEventListener('message', function (event) {
			if (event.data === 'reloadOnce') window.location.reload();
		});
	</script>
</head>

<body class="blocking-mode">
	<div id="modal">
		<header><h1><script>document.write(_('JavaScript Blocker'));</script></h1></header>
	</div>
	
	<header><h1><script>document.write(_('JavaScript Blocker'));</script></h1></header>
	
	<div id="container">
		<div id="find-bar">
			<input type="button" id="find-bar-done" value="Done" />
			<input type="search" id="find-bar-search" incremental="incremental" results="10" autosave="find_on" />
			<label for="find-bar-search" id="find-bar-matches"></label>
		</div>
		<div id="setup" class="whoop">
			<p>
				<a class="outside" href="http://javascript-blocker.toggleable.com/">
					<img src="images/toggleable.png" alt="Toggleable" style="margin-bottom: -5px;"/>
					<img src="Icon-32.png" alt="JS Blocker" />
				</a>
			</p>
			<p><script>document.write(_('Thanks for using {1}', [_('JavaScript Blocker')]));</script></p>
			<p>
				<input type="checkbox" id="use-large" checked="checked" />&thinsp;<label for="use-large" id="large-label"><script>document.write(_('Use large font'));</script></label>
			<p>
				<input type="checkbox" id="block-manual" checked="checked" />&thinsp;<label for="block-manual"><script>document.write(_('Block scripts manually'));</script></label>
			</p>
			<p>
				<input type="checkbox" id="secure-only" />&thinsp;<label for="secure-only"><script>document.write(_('Scripts on secure sites must also be secure'));</script></label>
			</p>
			<p><input type="button" id="finish-setup" value="Finish Setup" /></p>
		</div>
		<div id="main" class="whoop">
			<div id="page-lists">
				<label><script>document.write(_('Page:'));</script></label>
				<select id="page-list">
					<optgroup label="Main Page">
						<option>http://javascript-blocker.toggleable.com</option>
					</optgroup>
					<optgroup label="Inline Frame Pages">
						<option>http://example.com</option>
					</optgroup>
				</select>
			</div>
			<div class="info-container">
				<label class="allowed-label"><script>document.write(_('Allowed:'));</script></label> <span id="allowed-scripts-count">0</span>
				<input type="button" value="Block All" id="block-domain" />
			</div>
	
			<div id="allowed-script-urls">
				<ul class="main-wrapper"></ul>
			</div>
	
			<div class="info-container">
				<label class="blocked-label"><script>document.write(_('Blocked:'));</script></label> <span id="blocked-scripts-count">0</span>
				<input type="button" value="Allow All" id="allow-domain" />
			</div>
	
			<div id="blocked-script-urls">
				<ul class="main-wrapper"></ul>
			</div>
	
			<div class="info-container">
				<label class="unblocked-label"><script>document.write(_('Unblocked:'));</script></label> <span id="unblocked-scripts-count">0</span>
			</div>
	
			<div id="unblocked-script-urls">
				<ul class="main-wrapper"></ul>
			</div>

			<div id="disclaimer">
				<p>
					<input type="button" value="Rules" id="view-rules" />
					<input type="button" value="Help" id="js-help" />
					<input type="button" value="Project Page" id="js-project" />
					<input type="button" value="Disable JavaScript Blocker" id="disable" />
					<br style="clear:both;">
				</p>
				<p>
					<input type="button" value="Unlock" id="unlock" />
					<br style="clear:both;">
				</p>	
				<br style="clear:both;">
			</div>
		</div>
		<div id="rules-list" class="whoop">
			<div class="info-container">
				<p class="misc-info">0 domains, 0 rules</p>
				<input type="button" value="Close Rules List" id="rules-list-back" />
			</div>
			<div id="data">
				<p class="above-filter">
					<a href="javascript:void(0)" id="collapse-all"><script>document.write(_('Collapse All'));</script></a> <span class="label">￨</span>
					<a href="javascript:void(0)" id="expand-all"><script>document.write(_('Expand All'));</script></a> <span class="label">￨</span>
					<a href="javascript:void(0)" id="edit-domains"><script>document.write(_('Edit'));</script></a> <span class="label">￨</span>
					<a href="javascript:void(0)" id="reinstall-pre"><script>document.write(_('Reinstall Whitelist & Blacklist'));</script></a>
				</p>
				<p id="above-temporary" class="above-filter">
					<a href="javascript:void(0)" id="make-temp-perm"><script>document.write(_('Make Temporary Rules Permanent'));</script></a> <span class="label">￨</span>
					<a href="javascript:void(0)" id="remove-all-temp"><script>document.write(_('Remove Temporary Rules'));</script></a>
				</p>
				<div id="rules-filter-bar" class="filter-bar">
					<ul id="filter-type-collapse">
						<li class="label"><script>document.write(_('Visibility:'));</script></li>
						<li id="filter-all"class="selected"><script>document.write(_('Any'));</script></li>
						<li id="filter-collapsed"><script>document.write(_('Collapsed'));</script></li>
						<li id="filter-expanded"><script>document.write(_('Expanded'));</script></li>
					</ul>
					<div class="divider"></div>
					<ul id="filter-type-state">
						<li class="label"><script>document.write(_('State:'));</script></li>
						<li id="filter-state-all" class="selected"><script>document.write(_('Any'));</script></li>
						<li id="filter-enabled"><script>document.write(_('Enabled'));</script></li>
						<li id="filter-disabled"><script>document.write(_('Disabled'));</script></li>
						<li id="filter-temporary"><script>document.write(_('Temporary'));</script></li>
					</ul>
					<div class="divider"></div>
					<ul id="filter-type-domain">
						<li class="label"><script>document.write(_('Domains'));</script>:</li>
						<li id="li-domain-filter"><input type="search" placeholder="Domains" incremental="incremental" results="10" autosave="domain_filter" id="domain-filter" /><br style="clear:both;" /></li>
					</ul>
					<br style="clear:both;" />
				</div>
				<ul id="rules-list-rules"></ul>
			</div>
		</div>
		<div id="misc" class="whoop">
			<div class="info-container">
				<p class="misc-header"></p>
				<input type="button" value="Close" id="misc-close" />
			</div>
			<div id="misc-content"></div>
		</div>
	</div>
</body>
</html>